# 🚀 快速使用指南

## 📊 Excel测试数据表结构

### 表文件位置
`test_data/login_test_cases.xlsx`

### 表结构说明

| 列名 | 类型 | 必填 | 说明 | 示例值 |
|------|------|------|------|--------|
| **case_id** | 文本 | ✅ | 用例唯一标识符 | TC001 |
| **case_name** | 文本 | ✅ | 用例名称（简短描述） | 正确的账号和密码 |
| **username** | 文本 | ✅ | 登录用户名 | 513admin |
| **password** | 文本 | ✅ | 登录密码 | Ld@513.c |
| **expected** | 文本 | ✅ | 预期结果：`success` 或 `fail` | success |
| **description** | 文本 | ✅ | 用例详细描述 | 使用正确的超级管理员账号和密码登录 |
| **run** | 文本 | ✅ | 是否执行：`yes` 或 `no` | yes |

### 字段详解

#### case_id
- 用例的唯一标识符，建议使用 TC + 三位数字格式
- 示例：TC001, TC002, TC003...

#### case_name
- 用例的简短描述，会显示在测试报告中
- 建议使用清晰简洁的描述

#### username
- 要测试的用户名
- 可以为空字符串（测试空用户名场景）

#### password
- 要测试的密码
- 可以为空字符串（测试空密码场景）

#### expected
- **success**: 预期登录成功（URL会改变，没有错误提示）
- **fail**: 预期登录失败（显示错误提示信息）

#### description
- 用例的详细说明，帮助理解测试目的
- 会显示在Allure报告中

#### run
- **yes**: 执行该测试用例
- **no**: 跳过该测试用例（不执行）

### 现有测试用例列表

| case_id | case_name | username | password | expected |
|---------|-----------|----------|----------|----------|
| TC001 | 正确的账号和密码 | 513admin | Ld@513.c | success |
| TC002 | 错误的账号 | wronguser | Ld@513.c | fail |
| TC003 | 错误的密码 | 513admin | wrongpassword | fail |
| TC004 | 账号和密码都错误 | wronguser | wrongpassword | fail |
| TC005 | 空账号 | (空) | Ld@513.c | fail |
| TC006 | 空密码 | 513admin | (空) | fail |
| TC007 | 账号和密码都为空 | (空) | (空) | fail |
| TC008 | 账号包含特殊字符 | admin@123 | Ld@513.c | fail |
| TC009 | 密码包含空格 | 513admin | Ld @513.c | fail |
| TC010 | 账号大小写错误 | 513ADMIN | Ld@513.c | fail |

## 🎯 三步快速开始

### 步骤1: 安装依赖

```bash
# 方式1: 使用批处理脚本（推荐）
双击运行 "快速开始.bat"，选择选项 1

# 方式2: 使用命令行
pip install -r requirements.txt
```

### 步骤2: 调整元素定位器

**重要**: 在运行测试前，必须先调整元素定位器！

1. 打开登录页面 https://ldpg.rj.run/admin/signin
2. 按F12打开开发者工具，找到页面元素的定位器
3. 打开 `pages/login_page.py` 文件
4. 修改以下定位器为实际的定位器：

```python
# 在 LoginPage 类中修改这些定位器
username_input = (By.CSS_SELECTOR, "你的实际选择器")
password_input = (By.CSS_SELECTOR, "你的实际选择器")
login_button = (By.CSS_SELECTOR, "你的实际选择器")
error_message = (By.CSS_SELECTOR, "你的实际选择器")
```

📖 详细的元素定位方法请参考 `元素定位参考.md` 文档

### 步骤3: 运行测试

```bash
# 方式1: 使用批处理脚本（推荐）
双击运行 "快速开始.bat"，选择选项 4

# 方式2: 使用Python脚本
python run_tests.py

# 方式3: 使用pytest命令
pytest
```

## 📝 如何添加新的测试用例

### 方法: 直接在Excel中添加

1. 打开 `test_data/login_test_cases.xlsx`
2. 在表格最后添加新的一行
3. 填写所有必填字段
4. 保存文件
5. 运行测试即可

示例：
```
TC011 | SQL注入测试 | admin' OR '1'='1 | 123456 | fail | 测试SQL注入防护 | yes
```

## 🔧 常用命令

### 运行特定测试

```bash
# 运行数据驱动测试
pytest tests/test_login.py::TestLogin

# 运行正向测试
pytest tests/test_login.py::TestLoginPositive

# 运行异常测试
pytest tests/test_login.py::TestLoginNegative

# 运行指定用例ID
pytest tests/test_login.py -k TC001

# 运行多个指定用例
pytest tests/test_login.py -k "TC001 or TC002"
```

### 查看测试报告

```bash
# 生成Allure报告
allure generate reports/allure -o reports/allure-report --clean

# 打开Allure报告
allure open reports/allure-report

# 或者使用批处理脚本
双击 "快速开始.bat"，选择选项 5
```

### 并行执行测试

```bash
# 使用4个进程并行执行
pytest -n 4

# 自动检测CPU核心数
pytest -n auto
```

### 使用不同浏览器

```bash
# 使用Chrome（默认）
pytest --browser=chrome

# 使用Firefox
pytest --browser=firefox

# 使用Edge
pytest --browser=edge

# 使用无头模式
pytest --headless
```

## 🐛 调试技巧

### 1. 查看测试执行过程

```python
# config/config.py
HEADLESS = False  # 关闭无头模式，可以看到浏览器操作
```

### 2. 增加等待时间

```python
# config/config.py
IMPLICIT_WAIT = 20  # 增加隐式等待时间
```

### 3. 查看页面截图

- 测试失败时会自动截图保存在 `reports/screenshots/`
- 截图也会附加在Allure报告中

### 4. 查看日志

```bash
# 日志文件位置
reports/pytest.log
```

## 📋 测试报告说明

### Allure报告包含的信息

- ✅ 测试执行概览（通过/失败/跳过数量）
- ✅ 测试用例详情（步骤、参数、描述）
- ✅ 失败截图和页面源码
- ✅ 执行时间统计
- ✅ 历史趋势（多次执行）
- ✅ 分类统计（Feature、Story）

### 报告位置

- Allure报告：`reports/allure-report/`
- 测试日志：`reports/pytest.log`
- 截图：`reports/screenshots/`

## ⚠️ 注意事项

### 1. 元素定位器必须调整

项目中的元素定位器是通用示例，必须根据实际页面调整后才能正常运行。

### 2. 错误提示验证

如果实际的错误提示文本与配置不同，需要修改：

```python
# config/config.py
ERROR_MESSAGE = '实际的错误提示文本'
```

### 3. 登录成功判断

当前通过URL变化判断登录成功，如果需要其他判断方式，可以修改：

```python
# pages/login_page.py
def is_login_successful(self) -> bool:
    # 自定义判断逻辑
    pass
```

### 4. 依赖环境

- 确保已安装Python 3.8+
- 确保已安装Chrome/Firefox/Edge浏览器
- 确保已安装Java（用于Allure报告）

## 📞 获取帮助

### 查看文档

- `README.md` - 完整项目文档
- `元素定位参考.md` - 元素定位详细指南
- `使用指南.md` - 本文档

### 常见问题

1. **Q: 测试运行失败，提示找不到元素？**
   A: 需要根据实际页面调整 `pages/login_page.py` 中的元素定位器

2. **Q: Allure报告无法生成？**
   A: 确保已安装Java和Allure，并配置了环境变量

3. **Q: Excel文件读取失败？**
   A: 确保Excel文件已关闭，没有被其他程序占用

4. **Q: 测试执行很慢？**
   A: 可以使用并行执行 `pytest -n 4` 或减少等待时间

## 🎓 学习资源

- [Pytest官方文档](https://docs.pytest.org/)
- [Selenium文档](https://www.selenium.dev/documentation/)
- [Allure报告文档](https://docs.qameta.io/allure/)
- [Page Object模式](https://www.selenium.dev/documentation/test_practices/encouraged/page_object_models/)

---

**祝测试顺利！** 🎉
